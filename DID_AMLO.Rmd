---
title: "¿AMLO redujo los homicidios en la CDMX?"
author: "Patricio R. Estevez Soto"
email: "patricio.estevez.14@ucl.ac.uk"
twitter: "@prestevez"
date: "23/04/2018"
output:
    html_document:
pandoc_args: "--smart"
---

    ```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE,
                      comment="",
                      cache=TRUE,
                      dev=c("png"),
                      error=TRUE,
                      warning=FALSE,
                      message=FALSE,
                      include=FALSE)
```

El primer debate entre los candidatos a la presidencia de México se celebró el 23 de abril de 2018. Uno de los temas de este debate---y de hecho uno que preocupa a gran parte de la sociedad mexicana---fue la seguridad pública. La primera pregunta que debieron responder los candidatos fue:

>¿Qué medidas tomará usted como Presidente de la República para combatir la  violencia y qué le hace pensar que tendrá éxito donde todos los demás han fracasado?

Andrés Manuel López Obrador, candidato de la coalición "Juntos Haremos Historia", hizo referencia a la reducción en la incidencia delictiva en la Ciudad de México durante su administración como Jefe de Gobierno (Dic 2000 -- Jul 2005):

>Yo he tenido éxito. Fui Jefe de Gobierno de esta ciudad, y reduje la incidencia delictiva, y existen los datos oficiales que respaldan mi dicho. Bajó en el tiempo que fui jefe de gobierno el robo de vehículo con violencia y bajó también el delito de homicidio en el tiempo que fui, voy a dar un dato: en el último año de mi gobierno, 2005, 684 homicidios, el año pasado en la Ciudad de México, 1084 homicidios y si comparamos lo que ha sucedido a nivel nacional desde luego que fue exitosa nuestra experiencia. -- López Obrador

La aseveración de López Obrador fue cuestionada por sus contrincantes, quienes aseguraron que el gobierno de López Obrador fue "uno de los peores," enfatizando las cifras de secuestros, y la respuesta de la sociedad civil que organizó una marcha multitudinaria para protestar por la inseguridad. [Verificado 2018](https://verificado.mx/que-es-verificado-2018/) revisó las [frases y aseveraciones que hicieron los candidatos](https://verificado.mx/verdades-mentiras-candidatos-seguridad-violencia-debate/) en materia de seguridad durante el primer debate. En el tema de la incidencia delictiva en la Ciudad de México durante el mandato de López Obrador, comentó:

>El equipo de Verificado 2018 revisó las cifras oficiales delictivas de 2000 a 2005 y encontramos que efectivamente Andrés Manuel logró bajar el número de secuestros en la capital... Además, la incidencia delictiva bajó 12.87% durante el mandato de Andrés Manuel López Obrador. De 176 mil 747 delitos a 153 mil 977. Esto incluye delitos patrimoniales, delitos sexuales, homicidios, lesiones, secuestro, robo común, robo de ganado, robo en carretera, robo en instituciones bancarias y otros delitos. -- [Verificado 2018](https://verificado.mx/verdades-mentiras-candidatos-seguridad-violencia-debate/)

No disputo que las cifras oficiales efectivamente reflejen que la incidencia delictiva *en la Ciudad de México* haya disminuido durante la gestión de López Obrador. Sin embargo, lo que sí es preocupante, es que automáticamente se asuma que dicha disminución sea un efecto directo del gobierno de la Ciudad de México. Por ejemplo, [Patricio Solís](https://twitter.com/psolisaqui), del Colmex, aseguró que:

>AMLO puede afirmar que entre 2001 y 2005 la tasa de secuestros (según las cifras reportadas) disminuyó, porque efectivamente fue así. Puede incluso atribuirlo a su experiencia. Eso es parte de las licencias de la política, si bien en un medio académico matizamos y demandamos más evidencia por la dificultad de las imputaciones de causalidad. -- [Patricio Solís](https://twitter.com/psolisaqui/status/988592683542286342)

Por tanto, si aceptáramos dicha "licencia política," ¿de qué sirve hacer evaluación de política pública? ¿Es solo un ejercicio académico condenado a permanecer oculto en *Journals* de paga? Al contrario, es precisamente en la política cotidiana donde es crucial apoyarnos en evaluaciones serias y rigurosas para poder determinar si quienes pretenden gobernarnos pueden adjudicarse los resultados que presumen. De no hacerlo, seguiremos votando a ciegas.

Por tanto, sin un análisis más riguroso de los datos de la incidencia delictiva, no es posible determinar si las reducciones observadas en el número de delitos fueron consecuencia de las acciones del gobierno de Lopez Obrador, o si se debieron a factores externos a su administración.

# Investigando la causalidad

Evaluar la efectividad de las políticas públicas es una de las actividades más complicadas en las ciencias sociales. En el caso de la incidencia delictiva, es necesario medir el efecto de la política implementada en la cantidad de delitos registrados, al mismo tiempo que se controla por otras variables que pudieran haber afectado al fenómeno en cuestión.

La aseveración de López Obrador en la que se adjudica la reducción de la violencia en la Ciudad de México es problemática por lo siguiente:

- *Se enfoca en el cambio en la incidencia delictiva solamente durante el período en el que fue Jefe de Gobierno.*

¿Cómo sabemos que la incidencia delictiva no habría disminuido si López Obrador no hubiese ganado la jefatura de gobierno? No basta con medir los cambios durante el período de gobierno, para poder descartar la tendencia "natural" del fenómeno delictivo, es crucial medir también los cambios en la incidencia delictiva antes, durante y después del gobierno de López Obrador.

- *No considera el cambio en la incidencia delictiva en otros estados del país*.

¿Cómo sabemos que la reducción en la incidencia delictiva se debió a las acciones del gobierno de López Obrador en la Ciudad de México, y no a cambios externos que afectaron a otros estados del país? Para descartar el efecto de fenómenos externos, no basta con medir los cambios en la incidencia delictiva en la Ciudad de México, es necesario comparar esos cambios con las tendencias en una zona de control comparable donde no haya gobernado López Obrador.

# Este estudio

Este estudio busca responder a estas preguntas en el espíritu de contribuir a la---indispensable---discusión pública sobre las políticas de seguridad en México utilizando datos y análisis rigurosos. En ese sentido le sigue al buen esfuerzo que realizaron [Oscar Elton](https://twitter.com/OscarElton88), [Andrés Lajous](https://twitter.com/andreslajous), y [José Merino](https://twitter.com/PPmerino) en su análisis del [efecto de las fotomultas en los accidentes viales en la Ciudad de México](https://medium.com/@andreslajous/cámaras-y-radares-para-fotomultas-ni-son-todas-las-que-están-ni-están-todas-las-que-son-72bd44c38a9a).

Específicamente, este estudio investiga el efecto del gobierno de López Obrador en los homicidios dolosos en la Ciudad de México. Se restringió el análisis a homicidios por dos razones: 1) es sin duda uno de los delitos más graves que puede sufrir una persona, y por extensión la sociedad; y 2) las estadísticas oficiales del homicidio tienden a ser de mucha mejor calidad que delitos como el secuestro o la extorsión, puesto que no sufre de una cifra negra tan alta como estos.

Se utilizaron [los conteos mensuales de homicidios por estado que reporta el Secretariado Ejecutivo del Sistema Nacional de Seguridad Pública](http://secretariadoejecutivo.gob.mx/incidencia-delictiva/incidencia-delictiva-fuero-comun.php) de enero 1998 a octubre de 2017.

# Análisis de tendencias

```{r packages, include=FALSE}

library(dplyr)
library(ggplot2)
library(reshape2)
library(zoo)
library(glmmTMB)

```

```{r input, include=FALSE}

# Data in and subset

snsp <- read.csv("IncidenciaDelictiva_FueroComun_Estatal_1997-2017.csv")

snsp %>%
    filter(MODALIDAD == "HOMICIDIOS" & TIPO == "DOLOSOS") -> homicidios

## long ts

homicidioslong <- melt(homicidios, id = names(homicidios)[c(1:6)])

homicidioslong$MODALIDAD <- droplevels(homicidioslong$MODALIDAD)
homicidioslong$TIPO <- droplevels(homicidioslong$TIPO)
homicidioslong$SUBTIPO <- droplevels(homicidioslong$SUBTIPO)

names(homicidioslong)[7:8] <- c("mes", "count")

homicidioslong %>%
    group_by(AÑO, ENTIDAD, mes, INEGI) %>%
    summarise(homicidios = sum(count, na.rm = TRUE)) -> homicidioslong

homicidioslong$mes2 <- homicidioslong$mes
levels(homicidioslong$mes2) <- c(1:12)
homicidioslong$mes2 <- as.numeric(as.character(homicidioslong$mes2))

homicidioslong$mes3 <- zoo::as.yearmon(paste(homicidioslong$AÑO, homicidioslong$mes2), "%Y %m")

# Retirar datos de 1997 y final de 2017 (observaciones inconsistentes de origen)

homicidioslong %>%
    filter(AÑO != 1997) -> homicidioslong1

homicidioslong1[-which(homicidioslong1$AÑO == 2017 &
                           homicidioslong1$mes %in% c("NOVIEMBRE", "DICIEMBRE")), ] -> homicidioslong2

homicidioslong2$CDMX <- homicidioslong2$ENTIDAD

# CDMX dummy

levels(homicidioslong2$CDMX)[-7] <- "Resto del país"
levels(homicidioslong2$CDMX)[2] <- "CDMX"

## Periodo de gobierno de AMLO

months <- c(1:12)
AMLOtime <- c(paste(2001, months, sep = "-"), paste(2002, months, sep = "-"),
              paste(2003, months, sep = "-"), paste(2004, months, sep = "-"),
              paste(2005, 1:7, sep = "-"))
AMLOtime <- c("2000-12", AMLOtime)

AMLOzootime <- as.yearmon(AMLOtime)

which(homicidioslong2$mes3 %in% AMLOzootime) -> AMLOinds

homicidioslong2$period <- "Pre-2000-11"

homicidioslong2[AMLOinds,"period"] <- "2000-01 - 2005-07"

which(homicidioslong2$mes3 > as.yearmon("2005-07")) -> afterinds

homicidioslong2[afterinds,"period"] <- "Post-2005-07"

homicidioslong2$period <- as.factor(homicidioslong2$period)

homicidioslong2$period <- relevel(homicidioslong2$period, ref = "Pre-2000-11")

## Exploración de distribución por estado
# (Confirma presencia de zeros y sobredispersion)

homicidioslong2 %>%
    group_by(ENTIDAD) %>%
    summarise(meancount = mean(homicidios),
              vari = var(homicidios),
              disp = vari/meancount,
              mincount = min(homicidios),
              maxcount = max(homicidios)) -> resumenhomicidios

## Agregando datos de población (Proyecciones Anuales de CONAPO por estado)

load("basepryentMX.rdata")
names(basepryentMX)[2:3] <- c("año", "entidad")

basepryentMX$entidad <- as.factor(basepryentMX$entidad)
basepryentMX$cvegeo <- as.factor(basepryentMX$cvegeo)

basepryentMX %>%
    filter(año > 1997 & año < 2018) %>%
    group_by(año, entidad, id_ent) %>%
    summarise(poblacion = sum(pob)) -> poblacionestado

poblacionestado %>%
    filter(id_ent != 0) -> poblacionestado

names(poblacionestado)[c(1,3)] <- c("AÑO", "INEGI")
poblacionestado <- poblacionestado[,-2]

inner_join(homicidioslong2, poblacionestado) -> homicidiosfinal

```

Como primer paso en el análisis, se inspeccionan visualmente las tendencias de la incidencia de homicidios por mes. En la gráfica se observan dos patrones. Primero, la tendencia de los homicidios en la Ciudad de México ya presentaba una tendencia negativa desde el inicio de la serie, antes de que López Obrador asumiera la jefatura de gobierno (las líneas punteadas indican el período que gobernó López Obrador). La tendencia negativa continúa hasta alrededor de inicios del 2006, cuando se observa un incremento significativo hasta la fecha. Segundo, el patrón es muy similar al observado en el resto del país: una tendencia negativa desde el inicio de la serie desde 1998 hasta inicios del 2006, con incrementos significativos desde el 2006 a la fecha (y un descenso importante en 2015). Ello sugeriría que hay poca evidencia de un efecto "AMLO" en la reducción de los homicidios en la Ciudad de Mexico, pues el descenso inicio antes de su mandato, y el patrón fue muy similar al observado en el resto del país.

```{r plot, fig.width=8, fig.height=4, echo=FALSE, include=TRUE}

homicidiosfinal %>%
    group_by(CDMX, AÑO, mes, mes3, period) %>%
    summarise(homicidios = sum(homicidios)) -> homicidiosCDMX

homplotcdmx <- ggplot(homicidiosCDMX, aes(x = mes3, y = homicidios))

homplotcdmx  + geom_line(alpha = 0.5) +
    stat_smooth(method = "loess", se = FALSE, span = .5, n = 100) +
    facet_wrap(~ CDMX, scales = "free_y") +
    geom_vline(xintercept = as.yearmon("2000-12"), linetype = 2) +
    geom_vline(xintercept = as.yearmon("2005-7"), linetype = 2) +
    xlab("Enero 1998 a Octubre 2017 (mensual)") +
    ylab("Homicidios absolutos") + theme_minimal()


```

Sin embargo, es importante notar que la inspección visual de las tendencias es un método muy poco riguroso para determinar si existe o no un efecto significativo del gobierno de AMLO en la incidencia de homicidios. La gráfica se presenta solo con fines ilustrativos, para tener una idea de cómo se comportaron las tendencias en el período de estudio.[^notagrafica] Para poder determinar estadísticamente si AMLO tuvo un efecto en la incidencia de homicidios es necesario aplicar un modelo econométrico a los datos.

[^notagrafica]: La gráfica presenta homicidios absolutos en lugar de la tasa de homicidios por dos razones. Primero, los datos de población por estado se derivan de las proyecciones demográficas que realiza la [CONAPO](http://www.conapo.gob.mx/es/CONAPO/Proyecciones_Datos). Dichas proyecciones estiman la población anual de cada estado con base en los resultados de los censos de población que realiza el INEGI. Dado que nuestros datos de homicidios son mensuales, sería necesario estimar la población por mes, lo cual incrementaría los errores en los datos. Si se utilizan las estimaciones anuales, la gráfica presentaría saltos abruptos cada doce meses por el cambio en el denominador. Dado que no se está comparando el total de los homicidios en la Ciudad de México y el resto del país, sino que se está observando la tendencia en ellos, utilizar las cifras absolutas es un medio apropiado para ello. Independientemente, dado que la población crece a un ritmo predecible (mientras que los datos de homicidio tienen mucha más variación), un análisis con tasas de homicidio daría resultados muy parecidos. De cualquier forma, en análisis estadístico de diferencias en diferencias sí utilizó los datos de población para calcular las tasas de homicidios.


# Diferencias en diferencias

Idealmente, para establecer el efecto causal de una política pública en un fenómeno social se diseñaría un experimento con controles aleatorios. En este tipo de investigación se dividen al azar las unidades de estudio y se asigna la mitad a un grupo de control y la otra a un grupo experimental; se mide la variable dependiente en ambos grupos (en este caso los homicidios) antes de realizar la intervención; se realiza la intervención solo en el grupo experimental; y se mide la variable dependiente en ambos grupos. Se considera que la política tuvo un efecto causal si la diferencia entre las mediciones antes y después de la intervención en el grupo experimental es distinta la diferencia en el grupo de control.

Sin embargo, en el caso de este estudio, este tipo de diseños no es de utilidad. Por tanto, la segunda mejor manera de determinar la causalidad es con un [experimento natural](https://es.wikipedia.org/wiki/Experimento_natural). En este diseño no se tiene control sobre la asignación de las unidades a grupos de control o experimentales, pero la lógica es similar: Se comparan las mediciones antes y después de la intervención en un lugar donde ocurrió la intervención, con las mediciones antes y después en lugares donde no hubo intervención. Para evaluar si las diferencias entre las mediciones son estadísticamente significativas usualmente se utiliza el modelo estadístico de [Diferencias en Diferencias](https://es.wikipedia.org/wiki/Diferencias_en_diferencias). El modelo es ampliamente utilizado para estudiar [los efectos de las políticas públicas](https://www.annualreviews.org/doi/pdf/10.1146/annurev-publhealth-040617-013507) cuando no es posible o ético realizar experimentos aleatorios, e inclusive se ha utilizado para determinar [la efectividad de intervenciones de prevención del delito](http://journals.sagepub.com/doi/abs/10.1177/0193841X11433827).

Considerando el caso de los homicidios en la Ciudad de México, el modelo puede representarse por la siguiente ecuación:

$$
ln(homicidios/poblacion) = \beta_1 cdmx + \beta_2 periodo + \beta_3 periodo * cdmx
$$

Donde la variable $homicidios$ representa el conteo mensual de homicidios en cada entidad federativa de enero 1998 a octubre de 2017, $poblacion$ corresponde a la población anual en cada entidad federativa, $cdmx$ es una variable binaria que indica si la observación corresponde a la Ciudad de México (y por tanto representa al grupo "experimental" bajo el gobierno de López Obrador), $periodo$ es una variable categórica que clasifica las observaciones temporales en tres períodos: antes de López Obrador (pre-Dic 2000), durante el gobierno de López Obrador (Dic 2000 -- Jul 2005), y después del gobierno de López Obrador. El coeficiente $\beta_1$ captura las diferencias globales entre la Ciudad de Mexico y el resto del país, mientras que $\beta_2$ captura las diferencias globales en la incidencia de homicidio entre los tres períodos. El efecto del gobierno de López Obrador en la incidencia de homicidio en la Ciudad de México lo captura el coeficiente $\beta_3$, por tanto, si López Obrador efectivamente redujo el homicidio en la ciudad durante su gobierno, esperaríamos ver un valor significativo y negativo en este coeficiente, $\beta_3 < 0$.

La implementación del modelo se hizo siguiendo la [distribución binomial negativa](https://es.wikipedia.org/wiki/Distribución_binomial_negativa), pues la variable dependiente es un conteo discreto con límite inferior de cero y sobredispersión. Se controlaron las diferencias entre entidades permitiendo la variación en los interceptos con un [modelo multinivel](https://es.wikipedia.org/wiki/Modelo_multinivel).

```{r dind}

dindformula <- formula(homicidios ~ CDMX * period + offset(log(poblacion)))

dind_poisson <- glmmTMB(dindformula, data = homicidiosfinal, family = poisson)

dind_nb <- glmmTMB(dindformula, data = homicidiosfinal, family = nbinom2)

lrtest <- lmtest::lrtest

mdind_poisson <- update(dind_poisson, . ~ . + (1|ENTIDAD))

mdind_nb <- update(dind_nb, . ~ . + (1|ENTIDAD))
sum_mdind_nb <- summary(mdind_nb)
```

```{r didresults, echo=FALSE, include=TRUE}
mdind_nb_estimates <- confint(mdind_nb)
mdind_nb_estimates <- mdind_nb_estimates[,c(3,1:2)]

rownames(mdind_nb_estimates) <- c("(Constante)",
                                  "CDMX",
                                  "periodo: 2000-12 - 2005-07",
                                  "periodo: Post-2005-07",
                                  "CDMX*AMLO",
                                  "CDMX*Post-2005-07",
                                  "Varianza: Entidad",
                                  "1/sigma")
mdind_nb_estimates[7,] <- mdind_nb_estimates[7,]^2

mdind_nb_estimates <- as.data.frame(mdind_nb_estimates)

mdind_nb_estimates$Significancia <- c("Significante", "NS", "Significante", "Significante",
                                      "NS", "NS", "Significante", "Significante")

knitr::kable(mdind_nb_estimates, digits = 2, align = c("r","r","r","c"),
             caption = "Resultados del modelo DID. obs. = 7616, grupos = 32.")


```

Los resultados del modelo indican que **no hay evidencia de que el gobierno de López Obrador haya sido responsable por el descenso en la incidencia del homicidio en la Ciudad de México**. En cambio, los resultados sugieren que los cambios en la incidencia en la Ciudad de México probablemente se deban a cambios en el fenómeno delictivo a nivel nacional.

La evaluación de las políticas públicas es una actividad crucial para la vida democrática, pues provee información esencial para determinar la efectividad de quienes pretenden gobernarnos. Dar licencia a quienes nos gobiernos de adjudicarse logros que no son suyos es también una falta a la rendición de cuentas. Invito a la comunidad académica y a la sociedad civil a continuar este ejercicio apoyándose en datos duros y análisis rigurosos.

Los análisis presentados en este documento se pueden replicar con los archivos disponibles en la siguiente [liga](https://github.com/prestevez/homicidiosCDMX).

# Anexo estadístico

Se reportan los resultados completos del modelo implementado, así como pruebas de significancia del mismo.

```{r annex, echo=FALSE, include=TRUE}

summary(mdind_nb)

lrtest(mdind_nb)

```

El modelo se evaluó contra especificaciones Poisson y se encontró significativo.

```{r poisson, echo=FALSE, include=TRUE}

lrtest(mdind_poisson, mdind_nb)

```

Asimismo, también se comparó contra una versión de un solo nivel (sin efectos aleatorios). La versión multinivel fue significativa.

```{r multilevle, echo=FALSE, include=TRUE}

lrtest(dind_nb, mdind_nb)
```